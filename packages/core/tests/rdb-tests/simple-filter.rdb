// Simple filter test for RDB test runner
// Tests basic filtering functionality with assert_or_save_expected

create or replace stream products;

// Create a flow that filters products over $100
create flow expensive_products as
products | where price > 100 | assert_or_save_expected("tests/expected/simple-filter.ndjson");

// Insert test data
insert into products {"id": 1, "name": "Laptop", "price": 999.99};
insert into products {"id": 2, "name": "Mouse", "price": 25.50};
insert into products {"id": 3, "name": "Monitor", "price": 450.00};
insert into products {"id": 4, "name": "Keyboard", "price": 75.00};
insert into products {"id": 5, "name": "Phone", "price": 799.99};

flush products;